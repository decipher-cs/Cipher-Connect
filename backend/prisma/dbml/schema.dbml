//// ------------------------------------------------------
//// THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
//// ------------------------------------------------------

Table refresh_token {
  tokenOwnerIdRelation User [not null]
  tokenValue String [pk]
  username String [not null]
}

Table User {
  username String [pk]
  createTime DateTime [default: `now()`, not null]
  displayName String [not null]
  avatarPath String
  refreshTokens refresh_token [not null]
  message Message [not null]
  roomConfig room_config [not null]
  userRoom user_room [not null]
  passwordHash password_hash
  rooms Room [not null]
}

Table password_hash {
  key Int [pk, increment]
  username String [unique, not null]
  hash String [not null]
  user User [not null]
}

Table room_config {
  username String [not null]
  roomId String [not null]
  isHidden Boolean [not null, default: false]
  hasUnreadMessages Boolean [not null, default: true]
  isNotificationMuted Boolean [not null, default: false]
  user User [not null]
  room Room [not null]
  userRoom user_room

  indexes {
    (username, roomId) [pk]
  }
}

Table Room {
  roomId String [pk]
  roomDisplayName String
  roomDisplayImagePath String
  isMaxCapacityTwo Boolean [not null, default: false]
  roomType RoomType [not null]
  message Message [not null]
  userRoomConfig room_config [not null]
  userRoom user_room [not null]
  user User [not null]
}

Table user_room {
  username String [not null]
  roomId String [not null]
  configId Int [unique, not null]
  user User [not null]
  room Room [not null]
  roomConfig room_config [not null]

  indexes {
    (username, roomId) [pk]
  }
}

Table Message {
  key String [pk]
  senderUsername String [not null]
  roomId String [not null]
  content String [not null]
  createdAt DateTime [default: `now()`, not null]
  editedAt DateTime
  contentType MessageContentType [not null]
  MIME String
  sender User [not null]
  room Room [not null]
}

Enum RoomType {
  private
  group
}

Enum MessageContentType {
  audio
  video
  text
  image
  file
}

Ref: refresh_token.username > User.username

Ref: password_hash.username - User.username

Ref: room_config.username > User.username [delete: Cascade]

Ref: room_config.roomId > Room.roomId [delete: Cascade]

Ref: user_room.username > User.username [delete: Cascade]

Ref: user_room.roomId > Room.roomId [delete: Cascade]

Ref: user_room.(username, roomId) - room_config.(username, roomId) [delete: Cascade]

Ref: Message.senderUsername > User.username

Ref: Message.roomId > Room.roomId